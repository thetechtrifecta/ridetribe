generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider  = "postgresql"
  url       = env("POSTGRES_PRISMA_URL")
  directUrl = env("POSTGRES_URL_NON_POOLING")
}

model User {
  id            Int          @id @default(autoincrement())
  clerkUserId   String       @unique
  email         String  
  firstName     String
  lastName      String
  phone         String
  events        Event[]
  rides         Ride[]
  kids          Kid[]
  connections   User[]       @relation("UserConnections")
  connectedWith User[]       @relation("UserConnections")
}

model Ride {
  id              Int        @id @default(autoincrement())
  creator         User       @relation(fields: [creatorId], references: [id])
  creatorId       Int
  rideType        String
  pickupAddress   String
  dropoffAddress  String
  wouldDrive      Boolean
  seatsOffered    Int
  wantRide        Boolean
  seatsNeeded     Int
  kids            Kid[]
  eventId         Int?
  event           Event?      @relation(fields: [eventId], references: [id])
  @@unique([eventId, rideType])
}

model Kid {
  id              Int        @id @default(autoincrement())
  creator         User       @relation(fields: [creatorId], references: [id])
  creatorId       Int
  rides           Ride[]
  firstName       String
  lastName        String
  age             Int
  phone           String?
}

model Event {
  id            Int         @id @default(autoincrement())
  creator       User        @relation(fields: [creatorId], references: [id])
  creatorId     Int
  title         String
  address       String
  startTime     DateTime
  endTime       DateTime
  rides         Ride[]
}